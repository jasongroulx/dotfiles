- defaults:
    link:
      create: true
      relink: true
      force: true

- clean: ['~']

- shell:
  - description: Validating sudo credentials
    command: "sudo --validate"
  - description: Install Homebrew
    command: "[ -x \"$(which brew)\" ] || /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\""

- brewfile: 
    - Brewfile

- create:
    - ~/.dotfile-env
    - ~/Code
    - ~/.vim/colors
    - ~/Library/Application Support/Spectacle

- link: 
    ~/.vimrc: vim/vimrc
    ~/.vim/coc-settings.json: vim/coc-settings.json
    ~/.vim/colors: vim/colors
    ~/.gitconfig: gitconfig
    ~/.gitignore_global: gitignore_global
    ~/.zshrc: zshrc
    ~/.my.cnf: my.cnf
    ~/Library/Application Support/Spectacle/Shortcuts.json: spectacle/Shortcuts.json

- shell: 
    - description: Adding .env variable for vim config
      command: echo 'VIM_INSTALL=~/.vim' >> ../.dotfile-env && echo 'DOTFILES=~/.dotfiles' >> ../.dotfile-env

    - command: "[ -d ~/.oh-my-zsh ] || sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" --silent --unattended --keep-zshrc"
      stdin: true
      stdout: true
      description: Install Oh My Zsh

    - command: "[[ \"$(ag $(which zsh) /etc/shells)\" ]] || sudo sh -c \"echo $(which zsh) >> /etc/shells\""
      description: Adding zsh to list of acceptable shells

    - command: "sudo chsh -s $(which zsh)"
      description: Making zsh the default shell

    - command: composer global require laravel/valet
      description: Downloading Laravel Valet

    - command: sudo valet install
      description: Configuring and installing Laravel Valet and DnsMasq

    - command: composer global require laravel/installer
      description: Downloading Laravel installer

    - description: Installing vim-plug
      command: "[ -f ~/.vim/autoload/plug.vim ] || curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim"

    - description: Installing vim plugins
      command: "vim +PlugInstall +qa"

    - description: Update MacOS settings
      command: source $HOME/.dotfiles/macos

